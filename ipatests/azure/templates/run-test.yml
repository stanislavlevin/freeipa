parameters:
  logsPath: 'logs'
  taskToRun: 'run-tests'
  testsToRun: ''
  testsToIgnore: ''
  testsToDedicate: ''

steps:
- script: |
    set -e
    docker exec --env TESTS_TO_RUN="${{ parameters.testsToRun }}" \
                --env TESTS_TO_IGNORE="${{ parameters.testsToIgnore }}" \
                --env TESTS_TO_DEDICATE="${{ parameters.testsToDedicate }}" \
                --env CI_RUNNER_LOGS_DIR="${{ parameters.logsPath }}" \
                --env SYSTEM_TOTALJOBSINPHASE=$(System.TotalJobsInPhase) \
                --env SYSTEM_JOBPOSITIONINPHASE=$(System.JobPositionInPhase) \
                --privileged -t \
                $(Build.BuildId)_master_1 \
                /bin/bash --noprofile --norc -x /freeipa/ipatests/azure/azure-${{parameters.taskToRun}}.sh
  displayName: Run test
